<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;700&display=swap" rel="stylesheet">

<title>Astrology Chart → Notion Import Tool</title>

<style>
body {
  font-family: "Jost", system-ui, sans-serif;
  font-weight: 400;
}

h1, h2, h3, th {
  font-weight: 700;
}

textarea {
  width: 75%;
  height: 75px;
  font-family: monospace;
  padding: 0.5rem;
}

button {
  padding: 0.75rem 1rem;
  background: #c6c2ff;
  border: none;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 1rem;
}

th, td {
  border: 1px solid #ccc;
  padding: 0.5rem;
}

th {
  background: #f0eae2;
}

.section {
  display: none;
  margin-top: 1rem;
}

.section button {
  margin-right: 0.5rem;
  margin-bottom: 0.5rem;
}

  
</style>
</head>

<body>

<h1>Import Astrology Chart Data</h1>

<p>
Paste each section from Astro-Seek’s <strong>AI-ChatGPT – Astrology Data Export</strong>
into the matching box below.
</p><br>

<h3>Planet positions:</h3>
<textarea id="planetInput"></textarea>

<h3>House positions:</h3>
<textarea id="houseInput"></textarea>

<h3>Planet aspects:</h3>
<textarea id="planetAspectInput"></textarea>

<h3>Other aspects:</h3>
<textarea id="otherAspectInput"></textarea>
<br><br>
<button onclick="parseAll()">Parse My Chart</button>

  
<!-- PLANETARY POSITIONS -->
<div id="planetSection" class="section">
  <h2>Planetary Positions</h2>

  <button onclick="copyTableToClipboard('planetTable')">
    Copy for Notion
  </button>
  <button onclick="downloadCSV('planetTable','planetary-positions.csv')">
    Download CSV
  </button>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Sign</th>
        <th>Motion</th>
        <th>Degree</th>
        <th>House</th>
      </tr>
    </thead>
    <tbody id="planetTable"></tbody>
  </table>
</div>


<!-- HOUSE POSITIONS -->
<div id="houseSection" class="section">
<h2>House Positions</h2>
  <button onclick="copyTableToClipboard('houseTable')">Copy for Notion</button>
<button onclick="downloadCSV('houseTable','house-positions.csv')">
  Download CSV
</button>
<table>
<thead>
<tr>
<th>House</th>
<th>Sign</th>
<th>Degree</th>
</tr>
</thead>
<tbody id="houseTable"></tbody>
</table>
</div>

<!-- ASPECTS -->
<div id="aspectSection" class="section">
<h2>Aspects</h2>
  <button onclick="copyTableToClipboard('aspectTable')">Copy for Notion</button>
<button onclick="downloadCSV('aspectTable','aspects.csv')">
  Download CSV
</button>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Planet 1</th>
<th>Type</th>
<th>Planet 2</th>
<th>Orb</th>
<th>A vs S</th>
</tr>
</thead>
<tbody id="aspectTable"></tbody>
</table>
</div>

<script>
const HOUSE_NAMES = {
  1: "1 • House of Self",
  2: "2 • House of Value",
  3: "3 • House of Communication",
  4: "4 • House of Family",
  5: "5 • House of Pleasure",
  6: "6 • House of Health",
  7: "7 • House of Relationships",
  8: "8 • House of Transformation",
  9: "9 • House of Purpose",
  10: "10 • House of Ambition",
  11: "11 • House of Friendship",
  12: "12 • House of Secrets"
};

const PLANET_ORDER = [
  "Sun","Moon","Ascendant","Mercury","Venus","Mars","Jupiter","Saturn",
  "Uranus","Neptune","Pluto","North Node","South Node","Lilith","Chiron",
  "Fortune","Vertex","Midheaven","Ceres","Pallas","Juno","Vesta"
];

function parseAll() {
  clearTables();
  parsePlanets();
  parseHouses();
  parseAspects();
  showSections();
}

function copyTableToClipboard(tableId) {
  const rows = document.querySelectorAll(`#${tableId} tr`);
  const text = [...rows].map(row =>
    [...row.children].map(cell => cell.textContent).join("\t")
  ).join("\n");

  navigator.clipboard.writeText(text);
  alert("Copied! Ready to paste into Notion ✨");
}

function downloadCSV(tableId, filename) {
  const rows = document.querySelectorAll(`#${tableId} tr`);
  const csv = [...rows].map(row =>
    [...row.children]
      .map(cell => `"${cell.textContent.replace(/"/g, '""')}"`)
      .join(",")
  ).join("\n");

  const blob = new Blob([csv], { type: "text/csv" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = filename;
  a.click();
  URL.revokeObjectURL(url);
}
  
/* ---------- PLANETS ---------- */
function parsePlanets() {
  const lines = document.getElementById("planetInput").value.split("\n");
  const rows = {};

  lines.forEach(line => {
    const match = line.match(
      /^(.*?) in (\w+) (\d+°\d+’)(?:, Retrograde)?, in (\d+)[a-z]{2} House/
    );
    if (!match) return;

    let name = match[1]
      .replace("ASC","Ascendant")
      .replace("MC","Midheaven");

    const sign = match[2];
    const degree = match[3];
    const houseNum = match[4];
    const motion = line.includes("Retrograde") ? "retro" : "direct";

    rows[name] = [
      name,
      sign,
      motion,
      degree,
      HOUSE_NAMES[houseNum]
    ];
  });

  PLANET_ORDER.forEach(p => {
    if (rows[p]) appendRow("planetTable", rows[p]);
  });
}

/* ---------- HOUSES ---------- */
function parseHouses() {
  const lines = document.getElementById("houseInput").value.split("\n");
  lines.forEach(line => {
    const match = line.match(/^(\d+)[a-z]{2} House in (\w+) (\d+°\d+)/);
    if (!match) return;

    appendRow("houseTable", [
      HOUSE_NAMES[match[1]],
      match[2],
      match[3]
    ]);
  });
}

/* ---------- ASPECTS ---------- */
function parseAspects() {
  const combined =
    document.getElementById("planetAspectInput").value +
    "\n" +
    document.getElementById("otherAspectInput").value;

  combined.split("\n").forEach(line => {
    cons
